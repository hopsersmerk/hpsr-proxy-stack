# Configuración de Squid Proxy
# Puerto HTTP (stunnel manejará el SSL)
http_port 3128

# Ejecutar como nobody (usuario sin privilegios que existe en el sistema)
cache_effective_user nobody

# Configuración de autenticación HTTP Basic
auth_param basic program /usr/lib/squid/basic_ncsa_auth /etc/squid/passwd
auth_param basic realm "Proxy Authentication Required"
auth_param basic credentialsttl 2 hours

# ACLs
acl authenticated proxy_auth REQUIRED
acl SSL_ports port 443
acl Safe_ports port 80
acl Safe_ports port 21
acl Safe_ports port 443
acl Safe_ports port 70
acl Safe_ports port 210
acl Safe_ports port 1025-65535
acl Safe_ports port 280
acl Safe_ports port 488
acl Safe_ports port 591
acl Safe_ports port 777
acl CONNECT method CONNECT
acl localnet src 10.0.0.0/8
acl localnet src 172.16.0.0/12
acl localnet src 192.168.0.0/16

# Reglas de acceso - requiere autenticación
http_access deny !Safe_ports
http_access deny CONNECT !SSL_ports
http_access allow localhost
http_access allow authenticated
http_access deny all

# Configuración de caché
cache deny all

# Logging - temporalmente deshabilitado para evitar problemas de permisos
# TODO: Habilitar logging una vez que Squid arranque correctamente
access_log none

# Sin mostrar versión de squid
httpd_suppress_version_string on

# Forward todo el tráfico
forwarded_for delete
via off
